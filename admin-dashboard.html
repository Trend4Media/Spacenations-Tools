<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Admin-Dashboard</title>
    <link rel="stylesheet" href="css/theme-variables.css">
    <link rel="stylesheet" href="css/global-footer.css">
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-gradient, linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%)); color: var(--text-primary, #e0e0e0); margin: 0; min-height: 100vh; padding: 20px; }
        .layout { display: grid; grid-template-columns: 280px 1fr; gap: 20px; }
        .panel { background: var(--bg-panel, rgba(0,0,0,0.7)); border: 2px solid var(--border-primary, #3a5998); border-radius: 14px; padding: 20px; box-shadow: 0 0 20px var(--border-shadow, rgba(58,89,152,0.3)); }
        .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .title { color: var(--accent-primary, #ff8c42); margin: 0; }
        .badge { display: inline-block; padding: 4px 10px; border-radius: 999px; font-weight: 700; background: linear-gradient(135deg, #06b6d4, #22d3ee); color: #002b36; font-size: 0.75rem; }
        .controls { display: flex; gap: 8px; }
        .btn { padding: 10px 14px; border-radius: 10px; border: 2px solid var(--card-border, #2b3a67); background: var(--card-bg, rgba(0,0,0,0.5)); color: var(--text-primary, #e0e0e0); font-weight: 600; cursor: pointer; }
        .btn.primary { background: linear-gradient(135deg, #3a5998, #4a90e2); color: white; border: none; }
        .btn.danger { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: none; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
        .stat { background: var(--card-bg, rgba(0,0,0,0.5)); border: 2px solid var(--card-border, #2b3a67); border-radius: 12px; padding: 16px; text-align: center; }
        .stat .value { font-size: 1.6rem; font-weight: 800; color: var(--accent-primary, #ff8c42); }
        .stat .label { color: var(--text-secondary, #b0b0b0); font-size: 0.9rem; }
        .search { display: grid; grid-template-columns: 1fr 150px; gap: 10px; margin-bottom: 12px; }
        .input { padding: 12px; border-radius: 10px; border: 2px solid var(--card-border, #2b3a67); background: rgba(0,0,0,0.5); color: white; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border-bottom: 1px solid rgba(255,255,255,0.08); padding: 10px; text-align: left; font-size: 0.95rem; }
        th { color: var(--text-secondary, #b0b0b0); font-weight: 700; }
        .role { display: inline-flex; gap: 6px; align-items: center; }
        .pill { padding: 3px 8px; border-radius: 999px; font-size: 0.75rem; font-weight: 700; }
        .pill.admin { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .pill.super { background: linear-gradient(135deg, #22c55e, #16a34a); color: white; }
        .pill.user { background: linear-gradient(135deg, #64748b, #475569); color: white; }
        .actions { display: flex; gap: 8px; }
        .warning { background: rgba(239,68,68,0.1); border: 1px solid #ef4444; color: #ef4444; padding: 10px; border-radius: 8px; margin-bottom: 10px; display: none; }
        .ok { background: rgba(34,197,94,0.1); border: 1px solid #22c55e; color: #22c55e; padding: 10px; border-radius: 8px; margin-bottom: 10px; display: none; }
        .hint { color: var(--text-secondary, #b0b0b0); font-size: 0.85rem; }
        @media (max-width: 1024px){ .layout { grid-template-columns: 1fr; } .grid { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="title">üõ°Ô∏è Master Admin-Dashboard</h1>
        <div class="controls">
            <a class="btn" href="index.html">‚Üê Zur Startseite</a>
            <button class="btn danger" id="logout-btn">Abmelden</button>
        </div>
    </div>

    <div class="layout">
        <aside class="panel">
            <h3 style="margin-top:0">üë§ Angemeldet</h3>
            <div id="admin-user-info" class="hint">L√§dt...</div>
            <hr style="border-color: rgba(255,255,255,0.08); margin: 16px 0">
            <div class="warning" id="access-denied">Zugriff verweigert. Nur Super-Admins.</div>
            <div class="ok" id="access-ok">Zugriff gew√§hrt.</div>
            <h3>‚öôÔ∏è Aktionen</h3>
            <div class="controls" style="margin-top: 8px; flex-wrap: wrap;">
                <button class="btn primary" id="refresh-btn">Aktualisieren</button>
                <button class="btn" id="export-users-btn">Benutzer exportieren</button>
            </div>
        </aside>

        <main class="panel">
            <div class="header" style="margin: 0 0 10px 0;">
                <h2 class="title" style="font-size:1.2rem">üìä √úbersicht</h2>
            </div>
            <div class="grid" id="stats-grid">
                <div class="stat"><div class="value" id="stat-users">-</div><div class="label">Benutzer</div></div>
                <div class="stat"><div class="value" id="stat-admins">-</div><div class="label">Alliance Admins</div></div>
                <div class="stat"><div class="value" id="stat-super">-</div><div class="label">Super-Admins</div></div>
                <div class="stat"><div class="value" id="stat-active">-</div><div class="label">Aktiv (7 Tage)</div></div>
            </div>

            <div class="header" style="margin-top: 20px;">
                <h2 class="title" style="font-size:1.2rem">üë• Benutzerverwaltung</h2>
                <span class="badge">Live</span>
            </div>

            <div class="search">
                <input id="search-input" class="input" type="text" placeholder="Suchen nach Benutzername, E-Mail, Allianz...">
                <button class="btn" id="search-btn">Suchen</button>
            </div>

            <div style="overflow: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Benutzername</th>
                            <th>E-Mail</th>
                            <th>Allianz</th>
                            <th>Letzter Login</th>
                            <th>Rollen</th>
                            <th>Aktionen</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body">
                        <tr><td colspan="6" style="text-align:center; color: var(--text-secondary)">Laden...</td></tr>
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script src="js/firebase-config.js"></script>
    <script src="js/auth-manager.js"></script>
    <script src="js/firebase-sync.js"></script>
    <script src="js/admin-auth.js"></script>
    <script src="js/admin-dashboard.js"></script>
    <script src="js/global-footer-loader.js"></script>
</body>
</html>

